var Xui=function(){"use strict";function n(n){return{metadata:n.metadata,collapse:!1,dropdown:!1}}function t(n){var t=this;return{metadata:n.metadata,setFloor:function(n){return t.setFloor(n)}}}function r(n){var t=this;return{metadata:n.metadata,setMode:function(n){return t.setMode(n)}}}var o=function(n){this.app=n};return o.prototype.init=function(){var o=this,e=PetiteVue.reactive;this.data={UIInfo:n,UIFloors:t,UIControls:r,setMode:function(n){o.app.Camera[n]&&o.app.Camera[n]()},setFloor:function(n){return o.app.Scene.gotoFloor(n)},metadata:e({loaded:!1,mode:"panorama",thumb:null,floors:null,floorIndex:0,title:"",description:""})},PetiteVue.createApp(this.data).mount(this.app.$plugins.querySelector("[xui_components]")),this.app.use("MinMap"),this.app.store.on("metadata",(function(n){n.entry&&(o.data.metadata.thumb=o.app.resource.getUserResourceURL("thumb-2k.jpg")),o.data.metadata.title=n.title,o.data.metadata.description=n.description})),this.app.Camera.on("floor.changed",(function(n){var t=n.floorIndex,r=n.allVisible;o.data.metadata.floorIndex=r?"all":t})),this.app.Camera.on("mode.changing",(function(n){var t=n.toMode;o.data.metadata.mode=t})),this.app.Scene.on("ready",(function(){o.data.metadata.thumb=null,o.data.metadata.loaded=!0})),this.app.Scene.on("loaded",(function(){o.data.metadata.floors=((o.app.store.getValue("flooruser")||{}).floors||[]).map((function(n){return{name:n.name,subgroup:n.subgroup}})).reverse()}))},function(n,t){return new Promise((function(r){var e=new o(n,t);e.$name="Xui",e.$html='<div xui-components v-scope :style="metadata.thumb && { backgroundImage:`url(${metadata.thumb})`}"> <div xui-components-loading v-show="!metadata.loaded"> <div class="lds-dual-ring"></div> </div> <div xui-components-info v-scope="UIInfo({metadata})" v-show="metadata.loaded"> <div class="title" :class="{collapse:collapse}" @click="dropdown=!dropdown"> <div class="pick" @click="collapse=!collapse"> <i class="iconfont sdk-back"></i> </div> <div class="text"> <div>{{ metadata.title }}</div> </div> <div class="drop" :class="{dropdown:dropdown}"> <i class="iconfont sdk-pull-down"></i> </div> </div> <div class="description" v-show="dropdown && !collapse" @click="dropdown=false"> <div class="text" v-html="metadata.description"></div> </div> </div> <div xui-components-floors v-scope="UIFloors({metadata})" v-show="metadata.loaded"> <ul v-show="metadata.floors && metadata.floors.length>1 && metadata.mode!=\'panorama\'"> <li :class="{active:\'all\' == metadata.floorIndex}" @click="setFloor(\'all\')" v-if="metadata.mode==\'dollhouse\'">全部</li> <li v-for="item in metadata.floors" :class="{active:item.subgroup == metadata.floorIndex}" @click="setFloor(item.subgroup)">{{item.name}}</li> </ul> </div> <div xui-components-controls v-scope="UIControls({metadata})" v-show="metadata.loaded"> <div class="buttons"> <div @click="setMode(\'panorama\')"><i class="iconfont" :class="[metadata.mode==\'panorama\'?\'sdk-panorama-active\':\'sdk-panorama\']"></i></div> <div @click="setMode(\'floorplan\')"><i class="iconfont" :class="[metadata.mode==\'floorplan\'?\'sdk-floorplan-active\':\'sdk-floorplan\']"></i></div> <div @click="setMode(\'dollhouse\')"><i class="iconfont" :class="[metadata.mode==\'dollhouse\'?\'sdk-dollhouse-active\':\'sdk-dollhouse\']"></i></div> </div> <div class="buttons"></div> </div> </div> \x3c!-- <template id="xui-components-loading">\r\n    <div class="lds-dual-ring"></div>\r\n</template> --\x3e \x3c!-- <template id="xui-components-info">\r\n    <div class="title" :class="{collapse:collapse}" @click="dropdown=!dropdown">\r\n        <div class="pick" @click="collapse=!collapse">\r\n            <i class="iconfont sdk-back"></i>\r\n        </div>\r\n        <div class="text">\r\n            <div>{{ metadata.title }}</div>\r\n        </div>\r\n        <div class="drop" :class="{dropdown:dropdown}">\r\n            <i class="iconfont sdk-pull-down"></i>\r\n        </div>\r\n    </div>\r\n    <div class="description" v-show="dropdown && !collapse" @click="dropdown=false">\r\n        <div class="text" v-html="metadata.description"></div>\r\n    </div>\r\n</template>\r\n<template id="xui-components-floors">\r\n    <ul v-show="metadata.floors && metadata.floors.length>1 && metadata.mode!=\'panorama\'">\r\n        <li :class="{active:\'all\' == metadata.floorIndex}" @click="setFloor(\'all\')" v-if="metadata.mode==\'dollhouse\'">全部</li>\r\n        <li v-for="item in metadata.floors" :class="{active:item.subgroup == metadata.floorIndex}" @click="setFloor(item.subgroup)">{{item.name}}</li>\r\n    </ul>\r\n</template>\r\n<template id="xui-components-controls">\r\n    <div class="buttons">\r\n        <div @click="setMode(\'panorama\')"><i class="iconfont" :class="[metadata.mode==\'panorama\'?\'sdk-panorama-active\':\'sdk-panorama\']"></i></div>\r\n        <div @click="setMode(\'floorplan\')"><i class="iconfont" :class="[metadata.mode==\'floorplan\'?\'sdk-floorplan-active\':\'sdk-floorplan\']"></i></div>\r\n        <div @click="setMode(\'dollhouse\')"><i class="iconfont" :class="[metadata.mode==\'dollhouse\'?\'sdk-dollhouse-active\':\'sdk-dollhouse\']"></i></div>\r\n    </div>\r\n    <div class="buttons"></div>\r\n</template> --\x3e <style> html {\r\n        box-sizing: border-box;\r\n        -webkit-text-size-adjust: 100%;\r\n        word-break: normal;\r\n        -moz-tab-size: 4;\r\n        tab-size: 4;\r\n    }\r\n\r\n    *,\r\n    ::before,\r\n    ::after {\r\n        background-repeat: no-repeat;\r\n        box-sizing: inherit;\r\n        appearance: none;\r\n        -webkit-tap-highlight-color: rgba(255, 255, 255, 0);\r\n        text-rendering: optimizeLegibility !important;\r\n        -webkit-font-smoothing: antialiased !important;\r\n    }\r\n\r\n    ::before,\r\n    ::after {\r\n        text-decoration: inherit;\r\n        vertical-align: inherit;\r\n    }\r\n\r\n    * {\r\n        padding: 0;\r\n        margin: 0;\r\n    }\r\n    [xui-components] {\r\n        width: 100%;\r\n        height: 100%;\r\n        pointer-events: none;\r\n        font-size: 14px;\r\n        user-select: none;\r\n        background-repeat: no-repeat;\r\n        background-position: center center;\r\n        background-size: cover;\r\n    }\r\n\r\n    [xui_min_map] {\r\n        top: 20px;\r\n        right: 20px;\r\n    } </style> <style> [xui-components-info] {\r\n        position: absolute;\r\n        left: 0;\r\n        top: 20px;\r\n        height: 34px;\r\n        border-radius: 0 34px 34px 0;\r\n        background: rgba(0, 0, 0, 0.3);\r\n        pointer-events: all;\r\n        color: rgba(255, 255, 255, 0.88);\r\n        z-index: 100;\r\n    }\r\n    [xui-components-info] .title {\r\n        display: flex;\r\n        align-items: center;\r\n        padding-right: 30px;\r\n        width: 100%;\r\n        height: 100%;\r\n        cursor: pointer;\r\n        transition: all 0.1s;\r\n        position: relative;\r\n    }\r\n    [xui-components-info] .title .pick {\r\n        width: 34px;\r\n        height: 34px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        cursor: pointer;\r\n        position: relative;\r\n        transition: all 0.1s;\r\n    }\r\n    [xui-components-info] .title .pick::after {\r\n        content: \'\';\r\n        position: absolute;\r\n        width: 1px;\r\n        height: 65%;\r\n        background: linear-gradient(transparent, #fff, transparent);\r\n        top: 50%;\r\n        transform: translateY(-50%);\r\n        right: 0;\r\n    }\r\n    [xui-components-info] .title .text {\r\n        width: 240px;\r\n        padding-left: 20px;\r\n        transition: width 0.3s;\r\n    }\r\n    [xui-components-info] .title .text div {\r\n        width: 100%;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n    }\r\n    [xui-components-info] .title .drop {\r\n        cursor: pointer;\r\n        display: flex;\r\n        position: absolute;\r\n        right: 0;\r\n        top: 0;\r\n        bottom: 0;\r\n        width: 24px;\r\n        align-items: center;\r\n        justify-content: flex-start;\r\n        color: inherit;\r\n    }\r\n    [xui-components-info] .title .drop i {\r\n        font-size: 14px;\r\n        transition: transform 0.2s ease-in-out;\r\n    }\r\n    [xui-components-info] .title .drop.dropdown i {\r\n        transform: rotate(180deg);\r\n    }\r\n    [xui-components-info] .title.collapse {\r\n        padding-right: 0;\r\n    }\r\n    [xui-components-info] .title.collapse .pick i {\r\n        transform: rotate(180deg);\r\n    }\r\n    [xui-components-info] .title.collapse .text,\r\n    [xui-components-info] .title.collapse .drop,\r\n    [xui-components-info] .title.collapse .pick::after {\r\n        display: none;\r\n    }\r\n    [xui-components-info] .description {\r\n        position: absolute;\r\n        left: 10px;\r\n        top: calc(100% + 10px);\r\n        background: rgba(15, 15, 15, 0.3);\r\n        border-radius: 10px;\r\n    }\r\n    [xui-components-info] .description .text {\r\n        padding: 20px;\r\n        width: 400px;\r\n        letter-spacing: 1px;\r\n        overflow: hidden;\r\n        word-break: break-all;\r\n        white-space: normal;\r\n        line-height: 1.5;\r\n    }\r\n    [xui-components-info] a {\r\n        color: rgba(14, 235, 168, 0.7);\r\n    } </style> <style> [xui-components-floors] {\r\n        pointer-events: all;\r\n        position: absolute;\r\n        left: 20px;\r\n        top: 50%;\r\n        transform: translateY(-50%);\r\n    }\r\n    [xui-components-floors] ul {\r\n        margin: 0;\r\n        padding: 0;\r\n        list-style: none;\r\n        width: 50px;\r\n        border-radius: 6px;\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n        align-items: center;\r\n        padding: 20px 6px;\r\n        background: rgba(0, 0, 0, 0.3);\r\n    }\r\n    [xui-components-floors] li {\r\n        color: rgba(255, 255, 255, 0.7);\r\n        margin-top: 20px;\r\n        cursor: pointer;\r\n    }\r\n    [xui-components-floors] li:first-child {\r\n        margin-top: 0px;\r\n    }\r\n    [xui-components-floors] li.active {\r\n        color: rgba(14, 235, 168, 0.7);\r\n    } </style> <style> [xui-components-controls] {\r\n        width: 100%;\r\n        position: absolute;\r\n        left: 0;\r\n        right: 0;\r\n        bottom: 20px;\r\n        height: 34px;\r\n        display: flex;\r\n        justify-content: space-between;\r\n        transition: bottom 0.3s ease;\r\n        z-index: 100;\r\n    }\r\n    [xui-components-controls] .buttons {\r\n        pointer-events: all;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-around;\r\n        height: 34px;\r\n        border-radius: 17px;\r\n        background-color: rgba(0, 0, 0, 0.3);\r\n    }\r\n    [xui-components-controls] .buttons i {\r\n        font-size: 18px;\r\n        color: #fff;\r\n    }\r\n    [xui-components-controls] .buttons:first-child {\r\n        margin-left: 20px;\r\n    }\r\n    [xui-components-controls] .buttons:first-child > div {\r\n        position: relative;\r\n        margin-left: 20px;\r\n        margin-right: 20px;\r\n        cursor: pointer;\r\n    }\r\n    [xui-components-controls] .buttons:last-child {\r\n        margin-right: 20px;\r\n    } </style> <style> [xui-components-loading] {\r\n        position: absolute;\r\n        left: 50%;\r\n        top: 50%;\r\n        z-index: 100000;\r\n    }\r\n    .lds-dual-ring {\r\n        display: inline-block;\r\n        width: 70px;\r\n        height: 70px;\r\n    }\r\n    .lds-dual-ring:after {\r\n        content: \' \';\r\n        display: block;\r\n        width: 54px;\r\n        height: 54px;\r\n        margin: 8px;\r\n        border-radius: 50%;\r\n        border: 4px solid #fff;\r\n        border-color: #fff transparent #fff transparent;\r\n        animation: lds-dual-ring 1.2s linear infinite;\r\n    }\r\n    @keyframes lds-dual-ring {\r\n        0% {\r\n            transform: rotate(0deg);\r\n        }\r\n        100% {\r\n            transform: rotate(360deg);\r\n        }\r\n    } </style> ',e.$load=function(){return e.init()},r(e)}))}}();
